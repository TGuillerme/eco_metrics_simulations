% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{xcolor}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Response to reviewers},
  pdfauthor={Thomas Guillerme},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newenvironment{cslreferences}%
  {\setlength{\parindent}{0pt}%
  \everypar{\setlength{\hangindent}{\cslhangindent}}\ignorespaces}%
  {\par}

\title{Response to reviewers}
\author{Thomas Guillerme}

\begin{document}
\maketitle


Dear Editor,

We are grateful for the detailed and useful comments from all three reviewers
We have taken all their suggestions on board, integrated changes associated with the suggestion into the manuscript and responded to them in detail below
For clarity we have displayed the \textcolor{blue}{reviewers' comments in blue} and our own responses in black
We fully describe each change below.

Best regards,

Thomas Guillerme, on behalf of all co-authors.

\textcolor{blue}{\textbf{Reviewer: 1}}

\textcolor{blue}{Thank you for the opportunity to review this manuscript, which highlights the critical importance of selecting the appropriate metric for functional diversity when analyzing biological data
The authors used simulated and empirical data to explore the extent to which different functional diversity metrics effectively capture the ecological mechanisms that underlie the relationship between functional diversity patterns and ecological processes
By examining four distinct ecological mechanisms and assessing the ability of various diversity metrics to detect their effect on functional diversity compared to a null model, the authors demonstrated that the same dataset could yield different interpretations depending on the chosen metric
This variability underscores the risk of misinterpreting results and creating confusion in the explanation of key ecological mechanisms.}

\textcolor{blue}{The study is valuable and it has the potential to raise awareness of a significant methodological caveat in functional ecology that, if overlooked, could lead to misconceptions or a loss of knowledge
With the increasing availability of large public datasets on functional traits and the widespread use of functional analyses, it is critical to improve clarity around commonly used methods
However, I believe the manuscript requires revision before it can be recommended for publication
I have several points of critique and corresponding suggestions for improving the next version of this paper
In particular, more clarity is needed in several sections of the manuscript, and the results and discussion should be more effectively linked to the introduction and the study's aims
Additionally, parts of the results and discussion should be reframed to better convey the key message of the study and enhance the overall significance of the paper
I believe this approach would help make the paper less descriptive and provide readers with a clearer framework for selecting the appropriate functional metrics when conducting a functional analysis.}

\textcolor{blue}{Below, I have itemized my major comments and provided more detailed comments organized by the different sections of the manuscript.}

\textcolor{blue}{\textbf{Item 1.}}
\textcolor{blue}{You present four different ecological mechanisms that could drive the reduction observed in your data, and you assess the effectiveness of various diversity metrics in detecting this effect
However, the methodology for testing these relationships is not clearly presented
Specifically, it is unclear how these mechanisms were tested in relation to the null stressor model
The purpose of using a null model is to establish a reference point against which alternative hypotheses can be compared (in your case the four ecological mechanisms), allowing for the identification of whether the focal mechanisms significantly explain the observed patterns in the data (see Gotelli and Graves 1996 ``Null Models in Ecology'').}

We have now specified more clearly throughout the manuscript the role of our null mechanism in the experimental design
Namely:

\textit{This is used to establish a reference to be compared to the other mechanisms and to test how removing elements in a specific way influences the metrics scores compared to removing them randomly.}
Lines 149-151.

\textit{To ease interpretation of the results across a range of metrics with different orders of magnitudes of outputs and different random simulations, we first calculated the difference between the stressor of interest and the null stressor (e.g. $metric_{stressor20\%} - metric_{null20\%}$).
We then scaled these differences to be relative to the highest relative differences between all the simulations for that one metric and stressor (across the 4 levels of removal - 20\%, 40\%, etc.).}
Lines 273-279.

\textcolor{blue}{The effect of the focal mechanisms is well explained, but I believe a more explicit explanation of how these mechanisms were tested is necessary.
I recommend adding clear statements at the end of the introduction that outline how you tested the different mechanisms against the null model, along with the associated hypotheses and predictions (perhaps in table 1)
While you briefly mention this in the methods section (e.g., lines 198-201), it would be beneficial to include this information earlier to provide readers with a clearer framework for understanding your approach.}

We have now clarified our goal and expectations at the end of the introduction:

\textit{Our goal is to assess the relative performance of different metrics to capture the patterns of different mechanisms by comparing the score of various metrics under specifically approximated mechanisms and the absence of any specific mechanism (null mechanism).
We expect that our ability to capture a pattern does not only depends on the choice of metric (what) but also on the process and mechanism at hand (how and why).}
Lines 109-114.

We have clarified how and why we compare the metrics to the null mechanisms:

\textit{To understand the ability of each metric to capture a mechanism of interest, we compared their scores relative to the same metric scores of a null mechanism.
To ease interpretation of the results across a range of metrics with different orders of magnitudes of outputs and different random simulations, we first calculated the difference between the stressor of interest and the null stressor (e.g. $metric_{stressor20\%} - metric_{null20\%}$).
We then scaled these differences to be relative to the highest relative differences between all the simulations for that one metric and stressor (across the 4 levels of removal - 20\%, 40\%, etc.)
This resulted in each metric being scaled between $-1$ and $1$ where a negative difference can be interpreted as the random removal of elements leading to a higher metric score; a positive difference as the focal removal of elements (i.e. approximating equalisation, facilitation, filtering and competition) leading to a higher metric score; and a difference near $0$ meaning both the null stressor and the focal stressor having a similar effect on the metric score (Figs 1, 2 and 3).
We interpret this last scenario as the metric score being unable to clearly distinguish between a random removal of elements and a non random one.}
Lines 273-287.

Furthermore, we have added an expected results column to Table 1 as suggested.

\textcolor{blue}{Additionally, the use of both simulated and real data in your study should be better explained, with more details provided on the value and rationale behind this choice.
This would help to further justify your methodology and enhance the overall clarity and impact of your manuscript.}

We have rewritten the last paragraph of the introduction to include the following:

\textit{To apply our framework to a realistic context, we also used an empirical dataset of Hawaiian bird traits and looked at how anthropogenic pressures have shaped the trait space (mechanism; why) based on extinction events on Hawaiian islands before and after the year 1500 (process; how), and how different metrics (pattern; what) can lead to different interpretations of the data.
We show that, with a fixed process and mechanisms approximation, the choice of statistic to describe the pattern (the disparity or functional diversity metrics) has a great impact on the interpretation of the data, with the exact same data being sometimes interpreted in opposite ways.}
Lines 114-122.


\textit{We suggest caution when summarising patterns in observed data and propose a pipeline and tools for researchers to help understand how their pattern (often stemming from multidimensional data) can vary intuitively or not depending on the process and mechanism of interest.}
Lines 570-573.

\textcolor{blue}{\textbf{Item 2.}}

\textcolor{blue}{While I appreciate the detailed explanation of the methodology used to produce the simulated space patterns and the application of the stressors, this section appears disproportionate compared to the rest of the methods, especially concerning the testing of focal metrics
I recommend enhancing the clarity of Sections 3.1.3 and 3.1.4
Together with providing more explicit statements regarding your hypotheses and predictions (see item 1), it would help readers navigate the different aspects of the analyses
For instance, clarifying how the performance of each metric in capturing various focal mechanisms was evaluated, and how different results support or challenge this evaluation, would be beneficial.}

We have now rewritten sections 3.1.3 and 3.14 to be clearer:

\textit{To understand the ability of each metric to capture a mechanism of interest, we compared their scores relative to the same metric scores of a null mechanism.
To ease interpretation of the results across a range of metrics with different orders of magnitudes of outputs and different random simulations, we first calculated the difference between the stressor of interest and the null stressor (e.g. $metric_{stressor20\%} - metric_{null20\%}$).
We then scaled these differences to be relative to the highest relative differences between all the simulations for that one metric and stressor (across the 4 levels of removal - 20\%, 40\%, etc.)
This resulted in each metric being scaled between $-1$ and $1$ where a negative difference can be interpreted as the random removal of elements leading to a higher metric score; a positive difference as the focal removal of elements (i.e. approximating equalisation, facilitation, filtering and competition) leading to a higher metric score; and a difference near $0$ meaning both the null stressor and the focal stressor having a similar effect on the metric score (Figs 1, 2 and 3).
We interpret this last scenario as the metric score being unable to clearly distinguish between a random removal of elements and a non random one.
To assess these poor performances, we compared the distributions of the $171$ scores for each metric with each reduction level for each non-null stressor to the null stressor using pairwise t-tests.
The results of these tests are displayed in figure 2 (for the non-null stressor, grey distributions are not clearly distinguishable from the null stressor).}
Lines 273-291.

\textit{Finally, we measured the effect of the different strengths of the stressors (i.e. removing 20\%, 40\%, 60\% and 80\% the data) by fitting a linear regression using the scaled metric difference to the null score as a function of the amount of data removed
For each of these models, we reported the variance explained by the model (adjusted $R^2$) in the supplementary tables $2$ to $5$ and whether the slope was clearly distinguishable from $0$ (Figure 2b; \textit{sensu} Dushoff et al. 2019).
This allowed us to see if there was any predictable linearity in the metric scores.
In other words testing whether the metric scores relative to null removals where linearly scaling with the amount of data removed.}
Lines 292-299.

We have also added a panel to figure 1 helping the reader to easily interpret our results in figures 2 and 3.

\textcolor{blue}{\textbf{Item 3.}}
\textcolor{blue}{In my opinion the primary issue in the manuscript lies in how the results are communicated.
As mentioned in the abstract and introduction, your objective is to evaluate the effectiveness of various functional diversity metrics in capturing patterns and signals associated with ten distinct processes linked to common community assembly mechanisms.
From what I understand, your aim is to offer a framework that assists ecologists in selecting the most appropriate diversity metric based on the relevant mechanism and observed patterns.
However, I believe this crucial message is not clearly conveyed.
Instead, the main takeaway from your results and their interpretation seems to be the high variability observed in the performance of the studied metrics.}

\textcolor{blue}{I recommend revising the results and discussion sections to address this issue more effectively
Specifically, it would be helpful to provide a more detailed account of your main findings in the results section, particularly how different metrics performed in relation to the significance of your results, especially regarding the impact of data removal
Additionally, a more thorough interpretation of these results is needed in the discussion (what really means that a specific metric deviate from the null model, and what the effect of data removal from 20\% to 80\% really implies)
In the current manuscript, the discussion begins with an early focus on the limitations and caveats of your methods
While acknowledging these aspects is important, it would be more effective to simplify this discussion and move it to a later section
Instead, I would emphasize the interpretation of the performance of the various metrics to better communicate your main findings.}

We have now entirely reorganised the discussion section with clearer subsections:

\begin{itemize} 
  \item \textbf{Capturing approximated mechanisms with different metrics} discussing the simulated result in more details. Lines 369-405
  \item \textbf{Empirical results} focusing on the empirical results. Lines 407-448
  \item \textbf{Caveats} discussing clearly the caveats of our approach. Lines 450-505.
  \item  \textbf{Box 2: ``so which metric do \textit{I} choose?''} proposing a didactic approach and reflections to hopefully easily help workers to choose their own metric. Lines 506-553.
  \item \textbf{Conclusion} to briefly wrap up our findings. Lines 555-572.
\end{itemize}

\textcolor{blue}{\textbf{Item 4.}}

\textcolor{blue}{Finally, the discussion section needs additional work to better address the key aspects of ``what,'' ``how,'' and ``why'' in functional analyses.
The introduction emphasizes applying these fundamental questions of ecological analysis to the study of functional diversity metrics.
However, this focus seems to be lost in the discussion, which lacks a strong connection to the introduction.
Given that this is the core of your study (as reflected in the title), it should be the primary focus of the discussion section.
I recommend revising the initial part of the introduction to better align it with your main question and hypotheses and to clearly convey the core message of your study.
For example, a more detailed interpretation of how your results on different metrics relate to this aspect of your framework would be helpful.
As I mentioned in my previous item, acknowledging the limitations of your methods is important, but it should be addressed in a separate paragraph following the interpretation of your results, rather than being the primary focus of the discussion.}

We have now linked the framework of ``what'', ``how'' and ``why'' more clearly in the discussion:

\textit{For example, say one is interested in looking at changes in functional diversity using a divergence metric calculated with the probability density method (e.g. \texttt{TPD::REND}).
They can apply this metric to their trait space and get two relative metric scores of, say, $0.7$ and $0.65$ (pattern) for two levels of extinction (process).
The interpretation of this score as a change in functional diversity will depend on the worker's assumption of which mechanism affected the trait space.
In our simulations, if the mechanism approximated was the equalising one, the pattern can clearly be interpreted as a change in functional diversity, but if the mechanism is a facilitation one, the pattern can be meaningless (i.e. not clearly distinguishable from a null mechanism - Fig. 2 shows this example by contrasting row 5, columns 1 and 2).
In this made up example, the procedure is done in reverse order where the the pattern is specified first and then the process and the mechanism (``What process and mechanism are needed to interpret pattern X?'').
In Box 2 we suggest an approach that specifies the process and the mechanism first (``how do I interpret pattern X under a specific process and mechanism''; see Box 2).}
Lines 385-398

As well as in the new Box 2 lines 506-553.

\textcolor{blue}{\textbf{Item 5.}}

\textcolor{blue}{Ensure consistency in the use of terms such as ``elements of the model'' versus ``tips'' or ``species'', and adhere to a uniform citation format (e.g., using or omitting a comma before the year).}

We have now standardised terminology and provide a glossary in the supplementary materials (table 1; based on Mammola 2021).

\textcolor{blue}{Overall, addressing these areas will significantly enhance the paper's impact, readability, and contribution to the field of functional ecology.}

\textcolor{blue}{Here are more detailed comments on the different sections of the paper.}

\textcolor{blue}{\textbf{Abstract}.}

\textcolor{blue}{Line 3-6: Please rephrase to simplify and avoid brackets.}
%  We changed the sentence to:
%  \textit{Indeed, functional diversity metrics allow researchers to summarise complex occupancy patterns in space and/or time across communities and/or populations in response to various stressors
% In other words, investigating what, how and why something is changing in an ecosystem by looking at changes of patterns under a certain process through a specific mechanism.}
%  Lines @@@

\textcolor{blue}{Line 10-11: Please rephrase to avoid brackets.}
%  We changed the sentence to:
%  \textit{We studied the ability of different functional diversity metrics to recover patterns and signals from different processes linked to common assembly mechanisms in community ecology; such as environmental filtering, competitive exclusion, equalising fitness, and facilitation.}
%  Lines @@@

\textcolor{blue}{Line 14-15: If space requirements permit, please include more detailed information about your results.
The current description is too vague and does not effectively convey your main findings.}
%  We've expanded a little on the results
% One point of keeping the vagueness in the abstract though was to not give the impression that we provide any prescriptive results but rather a broad understanding that the choice of metric is important.
%  \textit{We show that different metrics perform differently when trying to capture signal from different approximation of common mechanisms relative to no mechanism at all (null).}
%  \textit{For example, the competition was harder to disentangle from the null mechanisms compared to facilitation in our simulations.}

\textcolor{blue}{\textbf{Introduction.}}

\textcolor{blue}{Line 25-28. It appears to me that you are using the definition of a functional trait from Violle et al.(2007) in Oikos. Please include a citation for this reference if it is the case.}
%  We've added the reference as suggested.

\textcolor{blue}{Line 37. I would avoid using the term ``new trait-focused ecology.'' While it's true that a more ``explicit'' approach to functional ecology has emerged over the past few decades, the foundation of functional analyses is rooted in the field of ecology itself.
For example, as you mentioned, Darwin's finches represent an early functional analysis centered on beak traits.
Although the specific term ``functional traits'' was less commonly used in the past, broader functional analyses were not uncommon, particularly in plant ecology (see, for example, Calow, P 1987 ``Towards a Definition of Functional Ecology.'' Functional Ecology; and Duarte et al., 1995 ``Comparative Functional Plant Ecology: Rationale and Potentials.'' Trends in Ecology \& Evolution).}
%  This is a really good point
% We've removed the mention of ``new''.

\textcolor{blue}{Line 73-74. Please clarify how this is related to the previous question ``what'' and ``how''.}
%  We've expanded the sentence to:
%  \textit{Mechanism description is then about linking the pattern and the process to some biological properties (sometimes referred to as ``rules'\,') and is at the core of answering the biological question at hand.}
%  Lines @@@

\textcolor{blue}{Line 93-96. Please explain why the chosen metric is not appropriate for the proposed example.}
%  We've expanded the sentence to:
%  \textit{In such a scenario, measuring the occupied area (i.e.~\(km^{2}\)) of each population on each island (a pattern - ``what?'\,') will not be the most appropriate way to understand the potential competition between these populations because it might not give information on whether the two populations actually interact in some way - a very likely condition for competition to take place.}
%  Lines @@@

\textcolor{blue}{Line 100. I think it would be beneficial to more clearly address your research question here. Is your goal simply to describe the patterns of functional diversity across different processes, or are you aiming to test how well different metrics capture the effects of various mechanisms? If it's the latter, how did you test this, and what are your expectations in relation to the null model?}
%  We have now clarified what our goal and expectations are in the last paragraph of the introduction:
%  \textit{Our goal is to assess the relative performance of different metrics to capture the patterns of different mechanisms by comparing the score of various metrics under specifically approximated mechanisms and the absence of any specific mechanism (null mechanism).}
%  \textit{We expect that our ability to capture a pattern does not only depends on the choice of metric (what) but also on the process and mechanism at hand (how and why).}
%  Lines @@@

\textcolor{blue}{Line 102. Please refer to Table 1 together with figure 1, to provide more details on the ecological mechanisms.}
%  We now refer to both the table and the figure.

\textcolor{blue}{Line 103-106.Please provide more information on why you chose to use a combination of empirical and simulated data.
From my understanding, your intention was to apply your framework within a more realistic context.
If that is the case, please clarify this point to strengthen your rationale.}
%  We changed the sentence to:
%  \textit{Beyond simulations, we also used an empirical dataset of Hawaiian bird traits and used pre-historical and historical extinction events on Hawaiian islands (process) resulting in a trait space modified by extinctions (the pattern) capturing the effects of species extinction on species trait distributions (the mechanism).}
%  Lines @@@

\textcolor{blue}{Line 106-111.
This content could be more suitable at the start of the discussion section.
Here you could maybe focus on outlining your hypotheses and predictions rather than presenting your conclusions.
By doing so, you establish a clearer context for interpreting your findings and guide the reader through the rationale behind your study.}
%  We have now moved this sentence to the end of the conclusion (Lines @@@) to end the introduction on a clear description of our goals and expectations:

% \textit{Through a simulation exercise, we analysed different patterns (what) across different processes (how) approximating different mechanisms (why) of interaction between organisms: equalisation, filtering, facilitation and competition (Figure \textbackslash ref\{Fig:simulations\} and \textbackslash ref\{Tab:mechanisms\}).}
%  \textit{Our goal is to test the relative performance of different metrics to capture the patterns of different mechanisms by comparing the score of various metrics under specifically approximated mechanisms and the absence of any specific mechanism (null mechanism).}
%  \textit{We expect that our ability to capture a pattern does not only depends on the choice of metric (what) but also on the process and mechanism at hand (how and why).}
%  \textit{To apply our framework to a realistic context, we also used an empirical dataset of Hawaiian bird traits and looked at how anthropogenic pressures have shaped the trait space (mechanism; why) based extinction events on Hawaiian islands before and after the year 1500 (process; how) and how different metrics (pattern; what) can lead to different interpretations of the data.}
%  \textit{We show that, that with a fixed process and mechanisms approximation, the choice of the statistic to describe the pattern (the disparity or functional diversity metrics) has a great impact on the interpretation of the data with the exact same data being sometimes interpreted in opposite ways.}

% Lines @@@

\textcolor{blue}{\textbf{Methods}.}

\textcolor{blue}{Line 115. Please provide more details of the elements of your model, as not all readers may be familiar with the Brownian Motion trait model.}
%  We clarified the sentence as follows:
%  \textit{First, we simulated a single random time dependent trait (Brownian Motion) under a model where lineages only speciate (no extinction; i.e.~a pure birth speciation model) until reaching 200 elements in \textbackslash texttt\{R\} \textbackslash citep\{rcore\} using \textbackslash texttt\{treats\} \textbackslash citep\{guillerme2024treats\}.}
%  Lines @@@

\textcolor{blue}{Line 131. Please explain what the distance D is.}
%  We clarified this point as follows:
%  \textit{Increasing density: by removing the required amount of pairs of points with a variable pairwise distance of at least \(D\) (i.e.~removing the \(n\) pairs of points that are at least \(D\) distance away from each other to remove the desired number of elements).}
%  Lines @@@

\textcolor{blue}{Line 139-144. I suggest breaking this section into two sentences and improve readability.
The current structure is challenging to follow.}
%  We split this sentence in three for clarity:
%  \textit{Each bandwidth has an observed probability of sampling of \(n\) (proportional to the number of elements in that bandwidth) and is skewed to a probability of sampling of \(n 
% times m^{p}\)
% For bandwidths with a low density (low values of \(n\)) we used \(m\>0\) to increase their resampling probability, and the opposite for bandwidths with a high density (high values of \(n\); using \(m\<0\) to decrease sampling property)
% This effectively flattened the normal distribution of the data by some factor \(p\) (here we used \(p=3\)).}
%  Lines @@@

\textcolor{blue}{Table 1. Please provide references for the Equalizing and Facilitation mechanisms to offer clearer context for the focal ecological mechanisms studied.}
%  We now added references to \textbackslash citep\{chesson2000mechanisms,barot2004mechanisms\} for the equalising mechanism and to \textbackslash citep\{bruno2003inclusion, danet2024species\} for the facilitation one.
%  Lines @@@

\textcolor{blue}{Line 183. Please provide the total number of the different metrics you used and refer to the table below (table 2).}
%  We've now added a reference to table 2 and summarised the total amount of metrics.
%  Lines @@@

\textcolor{blue}{Figure 1. I believe adding a color legend to the figure would enhance its clarity.}
%  We have now reworked figure 1 to be more didactic (especially for the results interpretation)
% We have not added the color legend to the plot itself (although we have added orange arrows to make it clearer) but in the caption to not overload an already busy figure.

\textcolor{blue}{Figure 1. Please include information in the figure caption explaining what the two types of graphs represent.}
%  We added the following clarifications to the figure caption:
%  \textit{We then applied different stressors to the resulting trait space
% We represent the elements removed by the stressors in blue and the ones kept in the trait space in orange
% The first column illustrate the distribution of the elements in one dimension with the overlap between the removed (blue) and kept (orange) elements in brown (note we did not measure any metric on 1D spaces)
% The second column illustrate the same distributions in 2 dimensions
% We did not illustrate the distributions in 4 or 8 dimensions here
% We used the following stressors:}
%  Lines @@@

\textcolor{blue}{Line 194-195. Please improve clarity.}
%  @@@TODO: rewrite following other reviewers comments (stats for results)

\textcolor{blue}{Line 201-203. Please simplify and improve clarity.}
%  @@@TODO: rewrite following other reviewers comments (stats for results)

\textcolor{blue}{Line 207-211. Please provide a clearer explanation of the effect size and statistical significance of these model outcomes, similar to the explanation provided in lines 198-201.}
%  @@@TODO: rewrite following other reviewers comments (stats for results)
%  @@@TODO: calculate effect sizes
%  We now added all the statistics results in the supplementary results from table 6 to 18.

\textcolor{blue}{Line 221. Please specify the added species.}
%  @@@TODO: name of the two added marine species

\textcolor{blue}{Table 2. The aspect for the third row is missing.}
%  We are not sure about what the reviewer meant here
% The tables are all formatted in LaTeX and we prefer to leave it to the production team to set it up as they like should the manuscript be accepted.

\textcolor{blue}{\textbf{Results}.}

\textcolor{blue}{Line 248-251. Please provide more detail regarding these results (e.g., what the scaled metric scores are, the effect size, and the significance of data reduction caused by the stressor). Additionally, refer to the relevant section of Figure 2 (to explain how the observed trends in the figure support this assertion), and to the tables in supplementary material.}
%  @@@TODO: add stats for results (following other reviewers comments)

\textcolor{blue}{Line 252. I would avoid the term ``naively''.}
%  We removed this term.

\textcolor{blue}{Line 254. Please ensure that the use of italics follows the guidelines from the journal.}
%  We did not find any specific guideline regarding emphasising words with italics but removed it nonetheless.

\textcolor{blue}{Line 254-256. Apply the same changes mentioned in the comment below to lines 248-251.}
%  @@@TODO: add stats for results (following other reviewers comments)

\textcolor{blue}{Line 260. Please avoid using the exclamation mark.}
%  We changed the punctuation to a dot.

\textcolor{blue}{Line 262-269. Please provide more detail regarding these results. Additionally, refer to the table in supplementary material.}
%  @@@TODO: add stats for results (following other reviewers comments)
%  We also now refer to the supplementary results:
%  \textit{For the empirical data, we see again a range of different possible interpretations depending on the metric describing the pattern (Figure \textbackslash ref\{Fig:empirical\_results\}, Supplementary table 5).}
%  Lines @@@

\textcolor{blue}{Line 275-283. This should be in the discussion section.}
%  We moved this paragraph to the discussion on lines @@@.

\textcolor{blue}{Figure 2. Maybe I misunderstood, but I think that you are missing the adjusted R square from the figure.}

%  We removed mention of the R2 (from a previous cluttered version of the figure) and now refer to it in the supplementaries in the figure caption.

\textcolor{blue}{Figure 3. Please provide more details in the figure caption. Please include the results from the t-test in the supplementary material.
While the significance of the test is demonstrated through the gray plots in Figures 2 and 3, the relative values are also necessary.}
%  The tables in the supplementary materials now contain the R2 values for both the Figures 2 and 3
% We have now clarified that in the figure captions:
%  \textit{The model results (including \(R^{2}\) and t-statistics) are available in supplementary table 4.}
%  Lines @@@ and Lines @@@

\textcolor{blue}{\textbf{Discussion}.}
\textcolor{blue}{Line 285-291. This section effectively summarizes your main goal and key message.
However, a more detailed interpretation of your main findings is needed.
I believe that simply stating that ``different metrics capture different patterns (what), leading to inferences about different processes (how) and mechanisms (why)'' is insufficient.
I recommend focusing more on the performance of the various metrics to offer readers a clearer framework for selecting the appropriate metric for each mechanism.
Please refer to items 3 and 4 for further details.}

\textcolor{blue}{Line 291-302.
I appreciate the detailed discussion of the potential limitations of your methodology.
However, in my opinion, this should follow a more in-depth interpretation of your results and their relation to the ``what'', ``how'', and ``why'' questions.
Consider placing the discussion of caveats and limitations in a separate paragraph, where you address the constraints of your framework.}

\textcolor{blue}{Line 303-315.
Based on your preference, I recommend moving this section further into the discussion.
This will allow you to address the importance of selecting the appropriate metric in relation to the number of dimensions used for the trait space.}
% We have now re-orginased the discussion and clearly separated each subsection
% The first one now discusses the results (simulated and empirical), the second one focuses on the caveats of our approach.
% And the third section is now a standalone box (box 2) discussing how we believe the what, how and why questions can help workers choose their functional diversity metric of interest based on their own data and question
% Hopefully these clear distinctions will make it easier to follow (or skip) for the reader.

\textcolor{blue}{Line 313-316. Please rephrase to improve readability.}
%  We have now removed this sentence.

\textcolor{blue}{Line 316-337. I think this section should be simplified.
The discussion focuses too heavily on the limitations of the approach, making it overly methodological.
A greater emphasis on the ecological implications of the results would better convey your main message.
I recommend streamlining this section and, if preferred, moving part of it to the supplementary material, where you can address the implications of scaling your results with the null model.}
%  We have now moved this section into the named ``caveats'' section
% Hopefully this will make it easier to skip for readers no interested in the methodological aspects of our work
% However, if the reviewer still thinks this section is too focused, we're happy to reduce it in a future version.

\textcolor{blue}{Line 321-324. When you refer to your findings, please provide a more explicit reference to the values you found and the relative graph to better guide the reader through your results and your interpretation.}
%  We have now specified which part of figure 2 we were using to illustrate this point:
%  \textit{(e.g.~facilitation mechanism measured as divergence using the probability density method - not distinguishable from null when removing 80\textbackslash\% or 60\textbackslash\% of the data; Figure \textbackslash ref\{Fig:simulations\})}
%  Lines @@@

\textcolor{blue}{Line 327. Please replace `workers' with `ecologists,' as you are referring to an example from an ecological study.}
%  We changed ``workers'' to ``researchers'' because not only ecologists are likely to work on such data/questions (e.g.~evolutionary biologists, palaeobiologists, etc.)

\textcolor{blue}{Line 339-340. Please simplify and increase readability.}
%  We reworded this sentence as follows:
%  \textit{The empirical results are also intriguing in that the loss of Hawaiian bird's functional diversity since 1500 is not greater than expected by chance (at least for certain metrics; Figure \textbackslash ref\{Fig:empirical\_results\}) because one would expect that extinctions since 1500 target specific areas of functional diversity space (i.e.~birds with specific trait combinations).}
%  Lines @@@

\textcolor{blue}{Line 340-361. I believe this section should be simplified and partially reframed.
While it's clear that you applied your framework to a real study case using empirical data, this section currently diverges too much from the main focus of your study.
Since your primary goal is to test functional diversity metrics, the main discussion should center on the performance of these metrics, their differences from the simulated data, and their relevance to the ``why'', ``what'', and ``how'' framework.
After addressing these points, you can briefly discuss the extinction dynamics of avian species in Hawaii.}
%  We have now expanded this section to be clearer:
%  \textit{This illustrates the importance of positing the mechanism and process of interest as well as the pattern to capture it before analysing the results.}
%  \textit{For example, for the divergence metrics using probability density, hypervolume or dendrogram methods, we recovered changes in trait space that are smaller than expected by chance for the species present before 1500 and larger than expected by change for the current species.}
%  \textit{This could lead to the interpretation that the trait space was not changed under any specific mechanism before 1500 (i.e.~null mechanism) but that since then, specific mechanisms have been reducing specific areas of the trait space (e.g.~filtering mechanism).}
%  \textit{However, when using a different metric (say the Rao's quadratic entropy based on distance matrices), the results would indicate that a reduction of specific areas of the trait space could have also occured before 1500 leading to very different interpretation of the results.}
%  Lines @@@

\textcolor{blue}{\textbf{Conclusion}.}

\textcolor{blue}{Similarly to my comments on the discussion, I suggest strengthening the connection between your conclusion and the main ``what, how, and why'' framewor.
This would enhance the overall flow of the paper and help the reader more clearly connect the main question and introduction to the final conclusions and discussion.}
%  We have now added the box 2 that would hopefully help with strengthening the connection between our results and the need to set up the ``what how and why'' framework for functional diversity analyses.

\textcolor{blue}{\textbf{Supplementary material}.}

\textcolor{blue}{Like for figure 2 in the main manuscript, I think that you are missing the adjusted R square from the figure.}
%  We have now specified in the caption that the adjusted R squares are available in the supplementary tables to not clutter the figure.

\textcolor{blue}{I enjoyed reviewing and with some time in revisions, this paper and the messaging will be stronger and more applied. I appreciate the framework and application this paper will support.}

\textcolor{blue}{\textbf{Reviewer: 2}}

\textcolor{blue}{Upon reading the title and introduction, I was intrigued and had high expectations for the proposed ``what, how, why'' framework of trait-based analysis.
However, after thoroughly reviewing the manuscript, it became clear that the study does not fully deliver on its initial promise of providing a guideline for applying this framework to ecological data analysis.
Instead, it focuses more on evaluating the varying responses of different functional diversity indices when specific data points are selectively removed from a dataset.
The primary outcome is that different functional diversity indices exhibit distinct and often unpredictable responses to data removal.
However, this observation, while valid, does not seem to offer significant new insights into ecological processes.
In essence, the study highlights the dependence of analytical outcomes on the choice of index - a finding that, while true, feels somewhat self-evident.}

\textcolor{blue}{It is possible that these concerns arise due to insufficient descriptions of the methodology and inconsistencies in terminology (specific points are detailed below).
As the manuscript stands, I am unable to recommend it for publication.
That said, I have outlined several constructive suggestions that I hope will assist the authors in revising and refining the paper.}

\textcolor{blue}{\textbf{General comments}}

\textcolor{blue}{\textbf{Main model idea}}

\textcolor{blue}{The paper falls short in demonstrating how the ``what, how, why'' framework can be applied to ecological data.
This issue may stem from examining two distinct layers: the simple removal of points from datasets and the subsequent interpretation of these removals in terms of ecological processes, which are not explicitly simulated in the model.
The distinction between these layers is confusing and is primarily addressed in Table 1, which does not effectively clarify these points.
To improve clarity, I recommend a more systematic presentation of these issues in the main text: This would involve, describing the relevant ecological processes (e.g., facilitation, filtering, competition), explaining how these processes influence species-associated trait distributions, and then outlining how these influences are represented in the five trait-removal processes.}

% We have now improved both the mechanisms approximation description (see comment below) as well as added more justification on why we believe our algorithms approximate the focal mechanisms (see response to the next comment).
%  Furthermore, we have also added some general predictions as to which type of metric would capture which type of changes in the trait space (Table 1).
%  We hope that these three points improve the clarity of our objectives and justifications.

\textcolor{blue}{\textbf{Model description:}}
The section on simulating trait-space patterns needs to be significantly expanded to include more technical details regarding how the simulations were conducted.
Key information, such as the model parameters, is entirely absent.
A more thorough explanation of the model setup, parameters, and procedures is required to ensure that the simulations can be reproduced without needing to consult external publications (such as those by Guillerme and Mammola).
To address this, I suggest adding a detailed explanation of the model in either the main Methods section or in a supplementary appendix, to ensure that all necessary parameters and computational steps are clearly specified.}

% We have now developed the explanation of the algorithms description as follows:
%  \textit{\textbackslash begin\{itemize\}}
%  \textit{\textbackslash item Random removal: by randomly removing 20\textbackslash\%, 40\textbackslash\%, 60\textbackslash\% or 80\textbackslash\% of the data.}
%  \textit{This approximates our \textbackslash textbf\{null mechanism\}
% This is used to establish a reference to be compared to the other mechanisms and to test how removing elements in a specific way influences the metrics scores compared to removing them randomly
% We chose this algorithm to approximate the absence of any specific stressor (i.e.~the removal of data only changes the number of observations, not the properties of the trait space).}

% \textit{\textbackslash item Decreasing size: by removing the required amount (20\textbackslash\%, 40\textbackslash\%, 60\textbackslash\% or 80\textbackslash\%) of data away from a distance (radius) \(
% rho\) of the centre of the trait space.}
%  \textit{\(
% rho\) is estimated for each trait space to match the required intensity
% For example, for one trait space, the algorithm estimated \(
% rho\_{20}\) to be the minimum radius excluding 20\textbackslash\% of the observations, \(
% rho\_{40}\) the one removing 40\textbackslash\%, etc
% (with \(
% rho\_{20} \> 
% rho\_{40} \> 
% rho\_{60} \> 
% rho\_{80}\)).}
%  \textit{This approximates our \textbackslash textbf\{equalising mechanism\}.}
%  \textit{We chose this algorithm to approximate equalisation assuming that a stressor could increase the probability of extinction for observations with more rare trait combinations (i.e.~observations on the edges of the trait space).}

% \textit{\textbackslash item Increasing density: by removing the required amount of pairs of points with a variable pairwise distance of at least \(D\).}
%  \textit{\(D\) is a distance estimated for each trait space to correspond to the minimal Euclidean distance that encompasses at least \(n\) pairs of points corresponding to the intensity of the stressor.}
%  \textit{For example \(D\_{20}\) is the distance that excludes any \(n\_{20}\) pairs of points that are a distance of at least \(D\_{20}\) from each other, \(D\_{40}\) is the distance that excludes \(n\_{40}\) pairs, etc
% (with \(D\_{20} \> D\_{40} \> D\_{60} \> D\_{80}\)).}
%  \textit{Note that this algorithm is not directly based on the change of average density but rather on the change in pairwise distance between observations.}
%  \textit{This approximates our \textbackslash textbf\{facilitation mechanism\} (i.e.~the points left are only ones that are close to at least another point in space).}
%  \textit{We chose this algorithm to approximate facilitation mechanism where a stressor could increase the probability of extinction for observations that are more isolated in the trait space.}
%  \textit{I.e
% pairs of observations that share a close trait combinations are more likely to remain (i.e.~observations adjacent to each other in the trait space).}

% \textit{\textbackslash item Shifting space: by removing the required amount of data from a distance (radius) \(
% rho'\) of the observation with the maximum numerical value on all dimensions.}
%  \textit{This is similar to the decreasing size algorithm but instead of choosing \(
% rho\) to be the radius from the centre of the trait space, \(
% rho'\) is a radius from the ``top right corner'\,' of the trait space.}
%  \textit{In other words the centre of the radius \(
% rho'\) is the observation with the highest numerical value on all dimensions - in a 2D representation this is the observation in the top right corner (with \(
% rho'\_{20} \> 
% rho'\_{40} \> 
% rho'\_{60} \> 
% rho'\_{80}\)).}
%  \textit{This approximates our \textbackslash textbf\{filtering mechanism\}.}
%  \textit{We chose this algorithm to approximate a flitering assuming that a stressor that could increase the probability of extinction for observations further from some trait combination optimum.}
%  \textit{This is similar to our equalising mechanism approximation but with the optimum not being in the center of the trait space (a region with a high density of observations) but with the optimum being in a corner of the trait space (a region with low density).}

% \textit{\textbackslash item Increasing evenness: by resampling the proportion of data (i.e.~20\textbackslash\%, 40\textbackslash\%, 60\textbackslash\% or 80\textbackslash\%) but with skewed resampling probabilities.}
%  \textit{In brief, this algorithm reduces the probability of resampling observations in regions of the trait space that have many observations and increases it in regions that have few observations.}
%  \textit{This is done by selecting of \(B\) discrete categories to summarise the distribution - i.e.~bandwidths - using Silverman's ``rule of thumb'\,' \textbackslash citep{[}\textbackslash texttt\{bw.nrd0()\} function in \textbackslash texttt\{R\};{]}{[}{]}\{silverman1986density\}.}
%  \textit{Each of these discrete category \(B\) has an observed probability of sampling of \(b\) (the proportion of observations in the category) and each observation then gets a probability of resampling scaling with the intensity of the stressor (the proportion of what to remove \(i\)) of \(i 
% times (1-b)^{p}\).}
%  \textit{Where \(p\) is factor increasing the scaling power of the algorithm (here we used \(p=3\)).}
%  \textit{In other words, observations in categories with a low density (\(b\<0.5\)) were more likely to be resampled and the ones in categories with high density (\(b\>0.5\)) were less likely to be resampled.}
%  \textit{This approximates our \textbackslash textbf\{competition mechanism\}, were observations in dense regions of the trait space are more likely to be removed than in sparse regions of the trait space.}
%  \textit{We chose this algorithm to approximate a stressor that could increase the probability of extinction for observations that share traits combination.}
%  \textit{This could approximate the fact that observation that have similar trait combinations are more likely to go extinct, due to competition (e.g.~using the same resources).}
%  \textit{\textbackslash end\{itemize\}}
%  Lines @@@

\textcolor{blue}{\textbf{Consistent terminology:}}

\textcolor{blue}{The paper's clarity is hindered by inconsistent, imprecise, and shifting terminology, making it unnecessarily difficult to follow.
For example, the entities generated by the model are referred to interchangeably as ``elements,'' ``traits,'' ``tips,'' or ``species,'' with no clear rationale for the variation.
Similar, for many other terms that are often used inconsistently or fuzzy (see detailed comments below).
This lack of consistency creates confusion and often forced me to repeatedly revisit sections of the text to discern the intended meaning.
To improve readability, I recommend establishing a consistent terminology early in the paper and adhering to it throughout.
This would significantly reduce ambiguity and enhance the reader's ability to follow the methodology and conclusions.}

% We have now standardised the terminology following \textbackslash cite\{guillerme2020shifting\} and \textbackslash cite\{mammola2021concepts\}
% In brief, elements, tips or species are now referred to as ``observations''; and traits, dimensions and columns as ``dimensions'' when referring to our simulation approach
% We also added a Glossary to the supplementary materials @@@ for clarity.

\textcolor{blue}{\textbf{Detailed comments:}}

\textcolor{blue}{L114: Really ``A single Brownian motion trait''? This implies that only a single trait dimension is generated, whereas from the later text it seems that higher-dimensional traits are simulated.}
%  By ``trait'' here we refer to the single process (Brownian Motion) which can be simulated in any number of dimensions (i.e.~generating a time dependent element value using 2, 4 or 8 dimension coordinates to describe it)
% In this context we differentiate ``dimensions'' which can be interpreted as a column in the data matrix, and the ``trait'' which is the definition of the measured (or simulated) feature
% For example, the trait ``geographical location'' can be described using two dimensions (latitude and longitude) or can be described as two traits (``latitude coordinate'' and ``longitude coordinate'')
% In this manuscript we preferred using the first definition
% We've clarified this as follows:
%  \textit{First, we simulated a single random time dependent trait (Brownian Motion) under a model where lineages only speciate (no extinction; i.e.~a pure birth speciation model) until reaching 200 elements in \textbackslash texttt\{R\} \textbackslash citep\{rcore\} using \textbackslash texttt\{treats\} \textbackslash citep\{guillerme2024treats\}
% This trait was simulated either as a 2, 4 or 8 dimensional trait, in other words a Brownian Motion simulated in a 2, 4 or 8 dimensional space.}
%  Lines@@@

\textcolor{blue}{L115: what is a ``tip''?}
%  By tip we meant a node with no descendants in an evolutionary tree
% We have now standardised the terminology (see response to general comment above).

\textcolor{blue}{L115, ``200 elements'': Why are so few data points used? A dataset of only 200 elements (reduced to 40 after data removal) seems exceptionally sparse, especially in a 4- or 8-dimensional space, as noted later in the text.
What is the motivation behind studying such a sparse space? One of the main advantages of using simple models like a branching process is that they allow for the generation of larger datasets, which would provide more robust statistics and better analytical power.}
%  @@@TODO: Rerun the simulations with 400, 800 and 1000 elements.
%  But also highlight that 40 species is already quite big
% We can also link that to the use of FD in palaeontology (disparity) where 40 is also already quite big!
% Tom's comment: *Reviewer 2's point about why we use only 200 data points - it's a while since I read our paper, but I guess we did that to make it more realistic in terms of the sample sizes people use. In island studies, 200 is pretty large, and I have many references (including my own ...) where people calculate FD using 1-5 species. So again we could make the argument that it represents a trade-off, between realistic sample sizes that people analyse vs large enough that we can really test the mechanisms


\textcolor{blue}{LL 120-124, ``four different stressors, five specific algorithms'': Inconsistency in the used terminology.
In this section, ``stressors'' appear to refer to the amount of data being removed (ranging from 20\% to 80\%), but later, the term ``stressors'' is used to describe the five data-removal processes---referred to as ``specific algorithms'' here.}
% We have now standardised the terminology throughout the manuscript (and included it in the glossary table in the supplementary materials): ``algorithm'' now designate the code algorithm, ``stressors'' (and ``stressors' intensity'') now designates how we modify the data (using the algorithms mentioned above) and ``mechanisms'' now designates the biological mechanisms we are approximating using a specific stressor (that is based on a specific algorithm)
% We've namely changed this section for clarity:
%  \textit{We then applied five different stressors to the trait space with different intensities.}
%  \textit{The five different stressors are effectively five specific algorithms removing either 20\textbackslash\%, 40\textbackslash\%, 60\textbackslash\% or 80\textbackslash\% of the data (the intensities of the stressors, resulting in trait spaces with, respectively, 160, 120, 80 and 40 observations).}
%  \textit{We used the following specific algorithms (Figure \textbackslash ref\{Fig:simulations\}; Table \textbackslash ref\{Tab:mechanisms\}; all algorithms, except ``increasing evenness'\,', were previously described in \textbackslash cite\{guillerme2020shifting\}):}
%  Lines @@@

\textcolor{blue}{L130, ``increasing density'': What is the motivation for this term? While I understand that this removal scheme may result in an overall increase in average density, the removal itself is not directly based on density but rather on pairwise distance in trait space.
For instance, the equalizing scheme would also lead to an increase in density.}
%  We used the term ``increasing density'' here to differentiate from ``decreasing size''
% The reviewer is totally correct in their understanding that, especially for normally distributed data, changes in density in the data actually occur to some extent with all the algorithms used here
% The stressor names and their algorithms are based on Guillerme et al 2020 and their implementation in the dispRity package: in their description they don't assume any specific distribution of the data a priori
% In fact, when using a uniform distribution, the decreasing size stressor does not change the density and the increasing density algorithm does not decrease the size of the trait space.
%  We've now added the following note to include the reviewer's comment:
%  \textit{Note that the algorithm used here to simulate the stressors depend, to some extent, to the distribution of the data for each trait space.}
%  \textit{The algorithms used can lead to similar stressors effects depending on the simulated data distribution.}
%  \textit{For example, ``increasing density'\,' and ``decreasing size'\,' stressors will lead to just what their name suggest if the observations are uniformly distributed (just average increase in density for ``increasing density'\,' and just overall decrease in size for the ``decreasing size'\,' stressors) but will have more or less similar effects (albeit no identical) in the case of a normal distribution (average increase in density and overall decrease in size for both ``increasing density'\,' and ``decreasing size'\,' stressors.)}
%  Lines @@@

\textcolor{blue}{L134, ``shifting space'': Similar to the previous point, this term is somewhat misleading.
This removal scheme does not explicitly shift the distribution; rather, it cuts the distribution at one edge, causing the mean to shift.
However, this effect of shifting the mean is not unique to this scheme - other removal schemes will generally result in a shift of the mean as well.}
%  This is also a fair point
% See comment above.

\textcolor{blue}{L135, ``with the maximal value'': What does ``maximal value'' mean for points in a higher-dimensional space? Maybe this refer to the location in trait space with the highest density of trait elements?}
%  We have now specified what we meant by maximal value:
%  \textit{Shifting space: by removing the required amount of data from a distance (radius) \(
% rho'\) of the observation with the maximum numerical value on all dimensions.}
%  \textit{This is similar to the decreasing size algorithm but instead of choosing \(
% rho\) to be the radius from the centre of the trait space, \(
% rho'\) is a radius from the ``top right corner'\,' of the trait space.}
%  \textit{In other words the centre of the radius \(
% rho'\) is the observation with the highest numerical value on all dimensions - in a 2D representation this is the observation in the top right corner (with \(
% rho'\_{20} \> 
% rho'\_{40} \> 
% rho'\_{60} \> 
% rho'\_{80}\)).}
%  Lines @@@

\textcolor{blue}{LL138- 145: I found this section on the competition method difficult to follow:}

\textcolor{blue}{- The term ``bandwidth'' is unclear.
What does ``bandwidth'' refer to in this context? Does it imply that resampling was done using a frequency-based method, or is it referring to a specific range or interval of trait values in the distribution? This ambiguity ties back to my earlier request for more technical details regarding the simulation process.}

\textcolor{blue}{- I am also unclear on the meaning of ``n''.
Could you clarify what ``n'' represents here? For example, what is meant by the ``probability of sampling of n'' and the reference to ``high/low values of n''? Without this information, it is difficult to grasp how the competition process is functioning.}

\textcolor{blue}{- The term ``flattening the curve'' needs more context.
What curve is being flattened, and how does this relate to the competition method?}

%  We have now completely rewritten the description of this stressor by defining more clearly what the bandwidth is, renaming the variables to be easier to understand, removed mention of flattening the curve and rewrote the equations to be specific to the increase in evenness (previous equations were generalised to both increase or decrease the eveness depending on the variable \textit{i} (formerly \textit{n}) being now always a proportion of removal (e.g.~0.2, 0.4, \ldots{} - former description worked with \textit{n} being also a proportion to add e.g.~1.2, 1.4, etc\ldots):
%  \textit{Increasing evenness: by resampling the proportion of data (i.e.~20\textbackslash\%, 40\textbackslash\%, 60\textbackslash\% or 80\textbackslash\%) but with skewed resampling probabilities.}
%  \textit{In brief, this algorithm reduces the probability of resampling observations in regions of the trait space that have many observations and increases it in regions that have few observations.}
%  \textit{This is done by selecting of \(B\) discrete categories to summarise the distribution - i.e.~bandwidths - using Silverman's ``rule of thumb'\,' \textbackslash citep{[}\textbackslash texttt\{bw.nrd0()\} function in \textbackslash texttt\{R\};{]}{[}{]}\{silverman1986density\}.}
%  \textit{Each of these discrete category \(B\) has an observed probability of sampling of \(b\) (the proportion of observations in the category) and each observation then gets a probability of resampling scaling with the intensity of the stressor (the proportion of what to remove \(i\)) of \(i 
% times (1-b)^{p}\).}
%  \textit{Where \(p\) is factor increasing the scaling power of the algorithm (here we used \(p=3\)).}
%  \textit{In other words, observations in categories with a low density (\(b\<0.5\)) were more likely to be resampled and the ones in categories with high density (\(b\>0.5\)) were less likely to be resampled.}
%  \textit{This approximates our \textbackslash textbf\{competition mechanism\}, were observations in dense regions of the trait space are more likely to be removed than in sparse regions of the trait space.}
%  Lines @@@

\textcolor{blue}{Figure 1: The caption is confusing and needs significant improvement.
Below are some specific points that require attention:}

\textcolor{blue}{- The caption completely omits any description of what is shown in left and right columns (i.e., 1d and 2d case).}
%  We have now clarified what each column contains in the figure caption.
\textcolor{blue}{- It is unclear whether this figure (both the 1d and 2d cases) is based on the actual simulations or is merely a schematic sketch.
For instance, in the right column, it seems unlikely that the figure actually depicts 200 points.}

% The figures does depict 200 points (200 blue in row A and 100 blue + 100 orange in the other columns).
% We have now specified this in the caption.
\textcolor{blue}{- The caption mentions a ``trait space of 2, 4, or 8 dimensions,'' yet a 1d trait space is shown.
If a 1d trait space is an illustrative example, this should be specified in the caption.}
%  We have now specified that we are showing 1 or 2 dimensions regardless of the number of dimensions per traits (i.e.~8 dimensional traits are not fully represented here but what's happening on their first and second dimensions is displayed here)
% We think one confusion on our part is the distinction between a dimension (a column in a matrix) and a trait (a measurable feature for an observation)
% In our case we are always only looking at one trait per trait space
% Although these traits can have 2, 4 or 8 dimensions
% We have now clarified this in the glossary.
\textcolor{blue}{- The pattern shown in the subfigure labeled ``2d facilitating mechanism'' appears questionable.
If point-pairs from a 2d distribution are removed based on a threshold distance, the resulting pattern would not typically resemble what is depicted here.}
%  The illustration of the 2D facilitating mechanism directly comes from the output of the dispRity::reduce.space function where the algorithm is implemented
% Here it selected every \textit{n} pairs of observations that are the closest to each other so that 50\% of the data is selected
% Here \textit{n} is 50 so that 100 observations are selected
% The algorithm is recursive so that once a pair of observations is selected, it cannot be selected again.
\textcolor{blue}{- Terminology: The use of the term ``species'' in the caption is confusing, as the methods seem to generate traits rather than species.}
%  We have now removed any mention of species.
\textcolor{blue}{- The phrase ``removing half of the species, resulting in two groups of tips'' is unclear.
How are these two groups defined? Presumably, one group consists of the removed traits and the other of non-removed traits.
Additionally, it is unclear which color (blue or orange) corresponds to which group.}
%  We have now specified this in the new caption.
\textcolor{blue}{- I am skeptical about the use of ecological terminology such as ``competition'' and ``facilitation'' in this context.
What is actually being shown are data distributions resulting from different point-removal algorithms, not ecological interactions per se.
While these processes can be discussed and associated with ecological mechanisms in the text or discussion (if well justified), using such terms directly in the figure caption is highly misleading.}
%  @@@TODO: Links back to main comment from reviewer 2: Go back to the previous version of table 1 that gives more description of the models
% One thing here is probably to justify more why we think that, for example, ``removing points from the side of a traitspace = filtering''.
%  We now changed the labels in the figure and the caption to highlight that we are indeed approximating such mechanisms, not simulating them per se as the reviewers pointed out.

\textcolor{blue}{LL 150-152: The description is unclear and appears to use the term ``simulation'' inconsistently.
In the phrase ``replicates per simulations,'' the term ``simulation'' seems to have a different meaning than in ``smallest number of simulations.'' Additionally, the first part of the sentence suggests that variance decreases with an increasing number of simulations, whereas the second part implies that adding more simulations leads to increased variance.}
%  There was a confusion indeed
% We now refer to ``the simulation pipeline'' for the whole set of replicates per stressors, and ``replicates'' for each individual run (one trait space + one stressor)
% We changed this sentence to:
%  \textit{We used 171 replicates because that was empirically the smallest number of replicates required to reach a variance between replicates lower than 1\textbackslash\% across all metrics (i.e.~any additional replicates beyond 171 added less that 1\textbackslash\% extra variance).}
%  Lines @@@

\textcolor{blue}{L 166: what does ``uncorrelated'' mean here? Does this mean that the branching process was independently repeated four times, once for each trait dimension, or does it mean that it generates four trait dimensions simultaneously, with these dimensions being uncorrelated?}
%  We meant that the dimensions for each multidimensional traits are uncorrelated (i.e.~the trait is a uncorrelated Brownian motion process in n dimensions)
% We have now clarified this point:
%  \textit{We repeated each simulation pipeline for 4 dimensional traits (generate a trait space and apply the stressor - Figure \textbackslash ref\{Fig:simulation\_results\}) for 2 and 8 dimensional traits with not correlation between each dimensions in each simulation pipeline (supplementary materials).}
%  Lines @@@

\textcolor{blue}{LL 170-178: why then did the authors not simply generate more data points (see my comment above)?}
%  @@@TODO: Rerun the simulations with 400, 800 and 1000 elements.

\textcolor{blue}{Table 1: The integration of this table into the main text could be improved.
Specifically, the abrupt mention of species (which are not part of the model) is confusing.}
%  We have now improved the context of the tables with predictions and removed most of the mentions of ``species'' now replaced by the standardised term of ``observations'' (unless they were specific examples).

\textcolor{blue}{L 178 and several instances later ``o'' should read ``0'' (zero).}
%  These integers were compiled using the latex mathpazo font
% We have now clarified them by changing into a default serif font.

\textcolor{blue}{L184, I suggest to mention here, that these functional metrics are denoted as trait space occupancy later on.}
%  Great suggestions
% We added the following:
%  \textit{We structured our simulations based on three aspects of diversity commonly captured by functional diversity metrics (trait space occupancy metrics; \textbackslash cite\{mammola2021concepts\}) using 12 metrics (Tab
% \textbackslash ref\{Tab:metrics\}):}
%  Lines@@@

\textcolor{blue}{L 208, ``\textasciitilde{}'' symbol: This usage of mathematical notation (instead of plain words) in a sentence (here, but also later in the text) is difficult to understand.}
%  We removed tilde symbols throughout the manuscript.

\textcolor{blue}{Table 2: Column two (``Methods'') does not provide any information beyond what is explained in ``Description'' and can be removed.}
%  We decided to keep the ``methods'' column to make it easier for the reader to refer to the terms used in Mammola et al.~2021 at a glance.

\textcolor{blue}{LL 252-260 ``opposite pattern to what was expected'' and ``nave expectation'': I do not agree.
It is well known that removing data points can increase the evenness of a distribution, so it is not surprising that removal procedures can result in a reduction of the metric scores.
The term ``space occupancy'' could be contributing to this misconception.}
%  We rewritten this section to be in line with the reviewer's comment:
%  \textit{Although most metrics captured a decrease in metric score relative to the amount of removed data, some metrics resulted into a score increase (e.g.~the functional evenness based on hypervolume for the equalising mechanism) or non-linear responses (e.g.~Alpha diversity based on dendrogram for the equalising mechanism).}
%  Lines @@@
%  Additionally, there appears to be a logical inconsistency
% Figure 2 illustrates the difference between two functional diversity metrics, rather than the metrics themselves
% Therefore, changes in this difference do not provide information about the individual increases or decreases of the metrics.
%  We have now added supplementary figures showing the scaled metric score changes (to keep the values manageable between 0 and 1) but not also scaled to the null mechanism changes (to display just the raw metric changes).

\textcolor{blue}{L 287: Why would this be ``unexpected''?}
%  We removed the word ``unexpected'' that was maybe ironic (and irrelevant regardless).

\textcolor{blue}{LL 287-289: I do not see that the ``what, how, why''-framework has really been used in this study.
Please specify, for example, which mechanisms have correctly been explained in the analysis?}
%  We have now reworked this section with the inclusion of a Box explaining in more details how we believe that using the ``what, how, why'' framework helps choosing the correct metric for a specific dataset and question.

% \textbf{Reviewer: 3}

% The question of whether modern methods are effective in extracting functional diversity patterns and relating them to ecological drivers is fundamentally important
% The authors conducted a consistent and accurate set of simulations to test how different methods and metrics measure functional diversity under various ecological processes, considering both simulated and real examples
% The approach used is reasonable and appropriate
% However, as it stands, I find it challenging to identify the specific hypotheses that the study aims to address, particularly regarding how different metrics or methodologies should approximate the different mechanisms tested
% Additionally, I found the discussion of the results to be too broad and lacking clear justification for the findings
% Consequently, the manuscript, as it reads, does not fully convey the novelty and the scientific gap filled by this work
% Therefore, I believe that a revision would be beneficial to improve the clarity of the manuscript's message.

% \textbf{Specific comments:}

% I think that, while the idea of the ``what?'', ``how?'', and ``why?'' questions is intriguing, the Introduction does not sufficiently articulate the specific aims addressed in the manuscript
% Specifically, through simulations, the authors approximate different ecological mechanisms that produce patterns in the functional space (as partially shown in Figure 1)
% These patterns and mechanisms are addressed in section 3.1.1 of the Methods, yet it is not clear how the different functional diversity metrics (i.e., richness, divergence, and evenness) should behave under these spatial reorganizations, particularly when compared to a null mechanism
% For instance, under the Equalizing mechanism, I would hypothesize that functional richness and divergence would decrease compared to the Null mechanism, while species distribution would become more even, given that species removed from the extremes of the space would pack towards the centre
% The signal might be expected to be stronger with increasing species removal, as species packing increases
% An accurate algorithm or method should be capable of detecting such a signal
% However, for mechanisms such as competition, the reasoning is not as straightforward (e.g., I am not convinced that richness metrics would decrease compared to the null mechanism in this case), particularly concerning expectations for divergence and evenness, as well as the relationship of these metrics to increasing species loss
% I believe that formulating clear ``hypotheses'' on species patterns in the space in relation to the various mechanisms tested may help readers better navigate through the metrics analysed
% This part could also be enhanced by introducing a new figure or expanding Figure 1 or Table 1 (which I found very well done).

% We have now improved the description of the algorithms (lines @@@) as well as added our predictions to Table 1 and improved Figure 1 to be a better tool to understand our simulation protocol and how to read the results figures.
%  Furthermore we agree with the reviewer that the effect of different mechanisms can be sometimes more intuitive than others (e.g.~in their example and counterexample of equalizing vs.~competition).

% We've expanded on the following paragraph:
%  \textit{Note that in empirical data, depending on the distribution of the data, some mechanisms can lead to similar or dissimilar patterns.}
%  \textit{For example, if the data are normally distributed, the equalising mechanisms, by removing data on the edges of the distribution also increases the density of the trait space (because normally distributed data are denser in the centre of the distribution), similarly to the facilitation mechanism.}
%  \textit{However, if the data are distributed uniformly, this does not happen.}
%  \textit{Furthermore, in real-world scenarios, we do not expect these mechanisms to act in isolation of each other: multiple mechanisms may stress the observed data simultaneously, with cumulative or synergistic effects.}
%  \textit{However, this is not tackled here for both simplicity and to understand how they work in isolation.}
%  \textit{Therefore the prediction of how each different mechanism approximation would affect the metrics (Table \textbackslash ref\{Tab:mechanisms\}) should be taken as a cautious guideline when dealing with empirical data where the distribution of the data might not be normal and where it could be affected by multiple mechanisms.}
%  Lines @@@

% Lines 165-170 and 303-307: As mentioned, TPD methods are implemented for a maximum of four dimensions
% I am curious about how the metric for the eight-dimensional space was computed
% Furthermore, although eight-dimensional spaces may be considered ``relatively small'' in morphological studies, ecological studies addressing both plants (Laughlin 2014, Daz et al.~2016, Weigelt et al.~2021) and animals (Healy et al.~2019, Mouillot et al.~2021, Cox et al.~2022, Beccari et al.~2024) generally use far fewer than eight dimensions
% Accordingly, I wonder if this was the reason behind selecting the four-dimensional space as the main analysis in Figure 2, or was it to allow comparison with the dimensionality of the empirical trait space? I believe this selection requires justification in the text.

% We add the following clarification in the methods for the 8 dimensional spaces:
%  \textit{We limited our simulations to a relatively small number of dimensions due to the constraints of some of the metrics used (e.g., \textbackslash texttt\{TPD::TPDsMean\} is only implemented for up to 4 dimensions; \textbackslash citealt\{carmona2019trait\} - note that int the supplementary figures, we measured the \textbackslash texttt\{TPD\} metrics on only the four first dimensions)}
%  Lines @@@
%  And:
%  \textit{Although this number of dimensions is in the range of many studies in ecology (e.g.~6 dimensions in \textbackslash citealt\{healy2019animal\}), it is not uncommon to use a much greater number of dimensions, especially in palaeontology (e.g.~more than 200 dimensions in \textbackslash citealt\{van2023should\}).}
%  Lines @@@

% We also specified the that we used only the four first dimensions for the TPD metrics in the supplementary results

% The use of bird traits is an interesting aspect that fits well with the scope of the manuscript
% However, for the same reason mentioned in the previous comment and as stated by the authors in lines 165-181, I am puzzled by the choice of five dimensions to portray the AVONET variation
% Morphological traits are generally highly correlated, resulting in a few axes explaining the highest proportion of trait variation and a space highly clustered in the centre with few species occupying its outer part (Pigot et al.~2020, Germain et al.~2023, Toussaint et al.~2024)
% How is the selection of five dimensions justified for the analysis? Are these properties of the dataset considered important for the example?
%  We chose to use five dimensions to describe the Hawaiian birds trait space to make sure that each focal group has at least 95\% of their variance described in the trait space (following Guillerme et al.~2023 protocol).
%  Furthermore, the choice of 5 dimensions is congruent with the suggestions from Pigot et al 2020 (``\textit{We have demonstrated that a minimum of four independent morphological trait axes are required to predict variation in avian trophic niches, calling into question the validity of trait-based macroecological analyses that assess functional diversity on the basis of fewer morphological trait dimensions}.'').
%  We have now specified this in the main text:
%  \textit{We selected the first \(5\) axes to represent the trait spaces that explained at least 95\textbackslash\% of the variance in each specific group (historic and extant species - see supplementary figure 7; following recommendations of \textbackslash citealt\{pigot2020macroevolutionary\} and dimensionality selection method from \textbackslash citealt\{guillerme2023innovation\}).}
%  Lines @@@

% I found the Results section very broad and believe it would benefit from specifying further details about discrepancies and similarities found among metrics
% Referring to my first comment, the authors mention expected patterns (like a decrease in trait space occupancy) that are not previously introduced in the text
% Similarly, I am not convinced by the expectation that all metrics (i.e., richness, evenness, and divergence) should generally increase compared to a null mechanism
% For instance, if the competition mechanism is removing species from the centre of the distribution (as specified in Figure 1), wouldn't it produce a decrease in functional richness but an increase in its divergence?

% We have now shorten the results to be more descriptive:

% \textit{The ability of different metrics to capture the different patterns (and thus approximate the processes) was highly variable.}
%  \textit{It ranged from metrics capturing no clear pattern (e.g.~the Functional evenness based on the dendrogram method for competition) to metrics clearly capturing one specific pattern (e.g.~Divergence based on probability density for the equalising mechanism for a decrease in space occupancy).}
%  \textit{Although most metrics captured a decrease in metric score relative to the amount of removed data, some metrics resulted into a score increase (e.g.~the functional evenness based on hypervolume for the equalising mechanism) or non-linear responses (e.g.~Alpha diversity based on dendrogram for the equalising mechanism).}
%  \textit{Some cases resulted in an increase in metric score relative to random removals (positive values in Figure \textbackslash ref\{Fig:simulation\_results\}).}
%  \textit{Furthermore, although we predicted some more common changes in aspects of functional diversity for some specific mechanisms, our simulation show that most metrics under most aspects (richness, divergence or regularity) capture changes of trait space occupancy under any mechanism (see caveats section in the discussion).}
%  Lines @@@

% However, we have now greatly expanded our discussion of these results in the discussions section under two subheadings (results, Lines @@@; and caveats Lines @@@)
% We felt there was a dilemma in 1) expanding the results at the cost of the discussion (i.e.~longer results section and shorter discussion one) which would have highlighted specific results but maybe downplayed some caveats; or 2) expanding the discussion at the cost of the results section which we felt more highlighted what we believe is the main takeaway from the results (``\textit{The ability of different metrics to capture the different patterns (and thus approximate the mechanisms) was highly variable.''}) and expanding where this variability comes from in the discussion (difficulties of interpreting multidimensional spaces + caveats stemming from our methodological choices).

% Lines 332-337: The rationale behind the choice of scaling for the null mechanism is unclear to me
% While I agree with the authors that this transformation may help in data visualization and interpretation, if scaling introduces such an artifact, why rely so heavily on these comparisons? Wouldn't it be more straightforward to simply compare metrics across each other without scaling?

% We have now expanded the section in the methods discussing the scaling:
%  \textit{To understand the ability of each metric to capture a mechanism of interest, we compared their scores relatively to the same metric scores of a null mechanism.}
%  \textit{To ease interpretation of the results across a range of metrics with different orders of magnitudes of outputs and different random simulations, we first scaled each metrics by their absolute greatest values to scale them between \(0\) and \(1\).}
%  \textit{We then calculated the difference between each scaled metric score under the stressors of interest (approximating equalisation, facilitation, filtering and competition) and the null stressor for each different stressor level (e.g.~\(metric\_{stressor20
% %} \- metric\_{null20
% %}\)).}
%  \textit{This resulted in each metric being scaled between \(1\) and \(1\) where a negative difference can be interpreted as the random removal of elements leading to a higher metric score; a positive difference as the focal removal of elements (i.e.~approximating equalisation, facilitation, filtering and competition) leading to a higher metric score; and a difference near \(0\) meaning both the null stressor and the focal stressor having a similar effect on the metric score (Figs \textbackslash ref\{Fig:simulations\}, \textbackslash ref\{Fig:simulation\_results\} and \textbackslash ref\{Fig:empirical\_results\}).}
%  \textit{We interpret this last scenario as the metric score performing poorly, i.e.~it is unable to clearly distinguish between a random removal of elements and a non random one.}
%  Lines @@@

% As well as updated figure 1 to hopefully improve the readability of the scaled results
% We believe that they are more interpretable than just displaying the raw results (now also available in the supplementaries), especially since it highlights how some metrics cannot distinguish between the null and the focal mechanism (e.g.~functional evenness using the dendrogram method for the competition) but can still distinguish from the null even when the range of change seems rather small (e.g.~functional evenness using the hypervolume method for competition).

% While I agree with the conclusion that the metric of choice should align with the research question or the specific pattern analyzed, I feel the Discussion is missing some mechanistic links
% The take-home message that different metrics are suitable for different ecological processes should be paired with an explanation or at least a suggestion of which metric may be more appropriate for which process
% For instance, the highest dispersion observed in the empirical dataset for RaoQ compared to other metrics may relate to the lower accuracy of the metric
% Without further details on the mechanisms of the metrics analyzed, I fear the reader may lose sight of the importance of metric choice and the implications of their different behaviors in addressing ecological processes.

% Although we did wish to expand the discussion with more clear messages of which metrics to use in which circumstances, we do not believe that the findings of our analysis justify prescriptive choice of specific metrics for specific scenarios
% As highlighted by the reviewer, although some metrics seem to work as better tools to capture changes in some specific scenarios, these are highly dependent on the type of data used here
% In the example of using the RaoQ having a lower accuracy than other methods, this might be true for this example dataset but we cannot posit that it would be the case for other datasets.

% To convey this message more clearly, we have now entirely restructured the discussion by separating it into sub-sections (simulated results, empirical results and caveats) as well as added a new text box (box 2) summarising how we believe that thinking more carefully about the pattern, process and mechanism allows for a better choice of functional diversity metric.

\end{document}